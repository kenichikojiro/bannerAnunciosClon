
CREATE TABLE APP_LOG
( 
	ID                   numeric(19)  IDENTITY ( 1,1 )  NOT NULL ,
	FECHA                datetime  NOT NULL ,
	MENSAJE              varchar(500)  NULL ,
	REF_ID               numeric(10)   NULL ,
	USUARIO              varchar(100)  NULL ,
	ENTIDAD              varchar(255)  NULL ,
	REV_ID               numeric(10)  NOT NULL ,
	REVTYPE              numeric(10)  NULL ,
	PARENT_REF_ID        numeric(10)  NULL 
);

ALTER TABLE APP_LOG
	ADD CONSTRAINT XPKAPP_LOG470803A4_4E7D6572_A4 PRIMARY KEY  NONCLUSTERED (ID ASC);

CREATE TABLE APP_LOG_DETAIL
( 
	ID                   numeric(19)  IDENTITY ( 1,1 )  NOT NULL ,
	ATTR_NAME            varchar(50)  NULL ,
	ATTR_VALUE           varbinary(max)  NULL ,
	TYPE                 numeric(1)  NULL ,
	DIFF                 numeric(1)  NULL ,
	ATTR_VALUE_STR       varchar(100)  NULL ,
	APP_LOG_ID           numeric(19)  NULL 
);

ALTER TABLE APP_LOG_DETAIL
	ADD CONSTRAINT XPKAPP_LOG_DETAIL9DA9684F_4DDE PRIMARY KEY  NONCLUSTERED (ID ASC);

CREATE TABLE FWK_ACCESO_USR
( 
	ID_ACCESO            numeric(10)  IDENTITY ( 1,1 )  NOT NULL ,
	ID_NUMCONTROL        numeric(10)  NOT NULL ,
	FH_ACCESO            datetime  NOT NULL ,
	FH_SALIDA            datetime  NULL 
);

ALTER TABLE FWK_ACCESO_USR
	ADD CONSTRAINT XPKFWK_ACCESO_USR2B6237E2_443D PRIMARY KEY  NONCLUSTERED (ID_ACCESO ASC);

CREATE TABLE FWK_AUDITORIA_REPORTES
( 
	ID                   numeric(12)  IDENTITY ( 1,1 )  NOT NULL ,
	ID_USR               numeric(10)  NOT NULL ,
	ID_PANTALLA          numeric(5)  NOT NULL ,
	ID_REPORTE           numeric(5)  NULL ,
	FECHA_EJECUCION      datetime  NOT NULL ,
	FILTROS_APLICADOS    varchar(255)  NULL 
);

ALTER TABLE FWK_AUDITORIA_REPORTES
	ADD CONSTRAINT XPKFWK_AUDITORIA_REPORTESE23D3 PRIMARY KEY  NONCLUSTERED (ID ASC);

CREATE TABLE FWK_DBTRACER
( 
	ID                   numeric(12)  IDENTITY ( 1,1 )  NOT NULL ,
	TSEVENTO             datetime  NULL ,
	USERID               varchar(20)  NULL ,
	ESQUEMA              varchar(50)  NULL ,
	TABLA                varchar(50)  NULL ,
	NIVEL                varchar(20)  NULL ,
	EVENTO               varchar(20)  NULL ,
	CAMPOSLLAVE          varchar(500)  NULL ,
	CAMPOS               varchar(1000)  NULL ,
	TIPODATO             varchar(1000)  NULL ,
	NULIDADCAMPOS        varchar(500)  NULL ,
	VALORESCAMPOS        varchar(4000)  NULL 
);

ALTER TABLE FWK_DBTRACER
	ADD CONSTRAINT XPKFWK_DBTRACERA057BA8A_4F5B12 PRIMARY KEY  NONCLUSTERED (ID ASC);

CREATE TABLE FWK_LOGGER
( 
	ID                   numeric(12)  IDENTITY ( 1,1 )  NOT NULL ,
	APPS_ID              numeric(5)  NULL ,
	TSEVENTO             datetime  NULL ,
	TSBASEDATOS          datetime  NULL ,
	NIVEL                varchar(10)  NULL ,
	CLASE                varchar(100)  NULL ,
	METODO               varchar(100)  NULL ,
	LINEA                numeric(10)  NULL ,
	MENSAJE              varchar(10)  NULL ,
	STACKTRACE           varchar(10)  NULL ,
	USERID               varchar(20)  NULL 
);

ALTER TABLE FWK_LOGGER
	ADD CONSTRAINT XPKFWK_LOGGERC6F083F3_48277F93 PRIMARY KEY  NONCLUSTERED (ID ASC);
ALTER TABLE [FWK_LOGGER] ADD CONSTRAINT [FK_FWK_LOGGER_FWK_CAT_APPS]	FOREIGN KEY ([APPS_ID]) REFERENCES [FWK_CAT_APPS] ([ID_APP]) ON DELETE No Action ON UPDATE No Action;

CREATE TABLE REV_INFO
( 
	REV                  numeric(10)  IDENTITY ( 1,1 )  NOT NULL ,
	REVTSTMP             numeric(19)  NOT NULL 
);

ALTER TABLE REV_INFO
	ADD CONSTRAINT XPKREV_INFO41719C5E_4F6A03DD_1 PRIMARY KEY  NONCLUSTERED (REV ASC);

CREATE TABLE STORED_PROC_LOG
( 
	ID                   numeric(19)  IDENTITY ( 1,1 )  NOT NULL ,
	USER_ID              varchar(20)  NULL ,
	FECHA_EVENTO         datetime  NOT NULL ,
	MENSAJE              varchar(200)  NOT NULL ,
	SOLO_DESARROLLADOR   numeric(1)  NOT NULL 
	CONSTRAINT Default_1_1097628743
		 DEFAULT  1
	CONSTRAINT VALORLOGICO_1380860028
		CHECK  ( SOLO_DESARROLLADOR BETWEEN 0 AND 1 ),
	SECCION_STORED_PROC  varchar(75)  NOT NULL ,
	ID_STORED_PROC       numeric(18)  NOT NULL ,
	CODIGO_MENSAJE       varchar(10)  NOT NULL 
);

ALTER TABLE STORED_PROC_LOG
	ADD CONSTRAINT XPKSTORED_PROC_LOGDFE72CC3_4FD PRIMARY KEY  NONCLUSTERED (ID ASC);

CREATE INDEX XIE1STORED_PROC_LOGDFE72CC3_4F ON STORED_PROC_LOG
( 
	CODIGO_MENSAJE        ASC
);


ALTER TABLE APP_LOG
	ADD CONSTRAINT FK_APP_LOG_REV_INFO_B54FD FOREIGN KEY (REV_ID) REFERENCES REV_INFO(REV)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION;


ALTER TABLE APP_LOG_DETAIL
	ADD CONSTRAINT FK_APP_LOG_DETAIL_APP_LOG_63DE FOREIGN KEY (APP_LOG_ID) REFERENCES APP_LOG(ID)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION;


ALTER TABLE FWK_ACCESO_USR
	ADD CONSTRAINT FK_FWK_ACCESO_USR_SEG_USUARECD FOREIGN KEY (ID_NUMCONTROL) REFERENCES SEG_USUARIO(ID)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION;


ALTER TABLE FWK_AUDITORIA_REPORTES
	ADD CONSTRAINT FK_FWK_AUDITORIA_REPORTES_S970 FOREIGN KEY (ID_USR) REFERENCES SEG_USUARIO(ID)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION;

ALTER TABLE FWK_AUDITORIA_REPORTES
	ADD CONSTRAINT FK_FWK_AUDITORIA_REPORTES_F97C FOREIGN KEY (ID_PANTALLA) REFERENCES FWK_CATALOGO_PANTALLAS(ID)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION;

ALTER TABLE FWK_AUDITORIA_REPORTES
	ADD CONSTRAINT FK_FWK_AUDITORIA_REPORTES_F885 FOREIGN KEY (ID_REPORTE) REFERENCES FWK_CATALOGO_REPORTES(ID)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION;


ALTER TABLE FWK_LOGGER
	ADD CONSTRAINT FK_FWK_LOGGER_FWK_CAT_APPS_D1D FOREIGN KEY (APPS_ID) REFERENCES FWK_CAT_APPS(ID_APP)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION;


ALTER TABLE STORED_PROC_LOG
	ADD CONSTRAINT FK_STORED_PROC_LOG_FWK_CAT_8D3 FOREIGN KEY (ID_STORED_PROC) REFERENCES FWK_CAT_CONTENT(ID_CONTENT)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION;
